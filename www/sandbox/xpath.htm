<!DOCTYPE html>
<html>
	<head>
		<title>Fleur XPath Test Page</title>
		<script type="text/javascript" src="js/fleur.js"></script>
	</head>
	<body>
		<pre id="xexpr"></pre>
		<pre id="result"></pre>
		<pre id="doc"></pre>
		<script type="text/javascript">
			/*globals Fleur */
			var req = new XMLHttpRequest();
			var parser = new Fleur.DOMParser();
			var ser = new Fleur.XMLSerializer();
			var xml;
			var xmldoc;
			var xexpr = "reverse(('A', 'b', 'cd', 'E'))[1]";
			document.getElementById("xexpr").innerHTML = xexpr;
			req.open('GET', 'data/data.xml', true);
			req.onreadystatechange = function() {
				if (req.readyState === 4) {
					if(req.status === 200) {
						xml = req.responseText;
						xmldoc = parser.parseFromString(xml, "application/xml");
						document.getElementById("doc").innerHTML = ser.serializeToString(xmldoc, true).replace(/</mg, "&lt;");
						document.getElementById("result").innerHTML = xmldoc.evaluate(xexpr, xmldoc, xmldoc.createNSResolver(xmldoc), Fleur.XPathResult.STRING_TYPE, null).stringValue;
					} else {
			      		document.getElementById("doc").innerHTML = "Not loaded!";
			      	}
				}
			};
			req.send(null);
		</script>
	</body>
</html>